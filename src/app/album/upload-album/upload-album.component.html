<div class="row" *ngIf="albumUploadData?.formGroup">
  <div class="col-sm-12 mb-3">
    <app-card [type]="3" [title]="'Upload Album' | translate" class="col-sm-12">
      <div cardBody3>
        <form [formGroup]="albumUploadData.formGroup" vgFocusFirstInvalid [form]="albumUploadData.formGroup" (ngSubmit)="onSubmit()">
          <div class="form-group">
            <label for="albumTitle">{{ 'Title' | translate }}</label>
            <input
              type="text"
              class="form-control"
              id="albumTitle"
              [placeholder]="('Enter' | translate) + ' ' + ('Album title' | translate)"
              formControlName="title"
            />
            <vg-error-section [label]="'Title' | translate" [group]="albumUploadData.formGroup" controlName="title"></vg-error-section>
          </div>
          <label>{{ 'Artist' | translate }}</label>
          <div formArrayName="artists" class="form-group" *ngFor="let artistControl of getAlbumArtists().controls; let i = index;">
            <div class="row">
              <div [formGroupName]="i" class="col-md-10">
                <vg-auto-input
                  [formControl]="$any(artistControl)"
                  [modelToTextMapper]="modelToTextMapper"
                  [modelToImgSrcMapper]="modelToImgSrcMapper"
                  [searchResults]="albumUploadData.filteredAlbumArtists"
                  (changeTextEvent)="suggestAlbumArtist($event)"
                ></vg-auto-input>
                <vg-error-section
                  [label]="('common.label.artist' | translate) + '#' + (i + 1)"
                  [control]="artistControl"
                ></vg-error-section>
              </div>
              <div class="col-md-2">
                <button type="button" class="btn btn-info rounded-lg mx-1" style="min-width: 2rem" (click)="addAlbumArtist()">+</button>
                <button
                  type="button"
                  class="btn btn-danger rounded-lg mx-1"
                  style="min-width: 2rem"
                  (click)="removeAlbumArtist(i)"
                  *ngIf="getAlbumArtists().controls.length > 1"
                >
                  -
                </button>
              </div>
            </div>
          </div>
          <div class="form-group">
            <label for="albumReleaseDate">{{ 'Release Date' | translate }}</label>
            <div class="input-group">
              <input
                class="form-control"
                placeholder="dd/MM/yyyy"
                id="albumReleaseDate"
                name="dp"
                ngbDatepicker
                #d="ngbDatepicker"
                formControlName="releaseDate"
                [minDate]="minDate"
              />
              <div class="input-group-append">
                <button class="btn btn-outline-secondary" (click)="d.toggle()" type="button">
                  <i class="bi bi-calendar3"></i>
                </button>
              </div>
            </div>
            <vg-error-section
              [label]="'Release Date' | translate"
              [group]="albumUploadData.formGroup"
              controlName="releaseDate"
            ></vg-error-section>
          </div>
          <div class="form-group">
            <label class="col-sm-4 px-0" for="albumCover">{{ 'Cover' | translate }}</label>
            <vg-file-input
              id="albumCover"
              formControlName="coverUrl"
              [remoteFileType]="'image'"
              [formData]="albumUploadData.formData"
              [formDataFilePart]="'cover'"
            ></vg-file-input>
          </div>
          <div>
            <button type="submit" class="btn btn-primary rounded-pill mb-2 float-right">{{ 'Submit' | translate }}</button>
          </div>
        </form>
      </div>
    </app-card>
  </div>
</div>
<div class="row" *ngFor="let songUploadData of songUploadDataList, index as j">
  <div class="col-sm-12 mb-3">
    <app-card [type]="3" [title]="('Song' | translate) + ' #' + (j + 1)" class="col-sm-12">
      <button cardEsc3 class="btn btn-info float-sm-right rounded-circle" style="margin-bottom: 1rem" (click)="removeForm(j)">
        <i class="bi bi-x-circle"></i>
      </button>
      <div cardBody3>
        <form [formGroup]="songUploadData.formGroup" vgFocusFirstInvalid [form]="songUploadData.formGroup">
          <div class="form-group">
            <label for="songTitle">{{ 'Title' | translate }}</label>
            <input
              type="text"
              class="form-control"
              id="songTitle"
              [placeholder]="('Enter' | translate) + ' ' + ('Song title' | translate)"
              formControlName="title"
            />
            <vg-error-section [label]="'Title' | translate" [group]="songUploadData.formGroup" controlName="title"></vg-error-section>
          </div>
          <div class="form-group">
            <label>{{ 'Artist' | translate }}</label>
            <div formArrayName="artists" class="form-group" *ngFor="let artistControl of getSongArtists(j).controls; let k = index;">
              <div class="row">
                <div [formGroupName]="k" class="col-md-10">
                  <vg-auto-input
                    [formControl]="$any(artistControl)"
                    [modelToTextMapper]="modelToTextMapper"
                    [modelToImgSrcMapper]="modelToImgSrcMapper"
                    [searchResults]="songUploadData.filteredSongArtists"
                    (changeTextEvent)="suggestSongArtist($event, j)"
                  ></vg-auto-input>
                  <vg-error-section
                    [label]="('common.label.artist' | translate) + '#' + (k + 1)"
                    [control]="artistControl"
                  ></vg-error-section>
                </div>
                <div class="col-md-2">
                  <button type="button" class="btn btn-info rounded-lg mx-1" style="min-width: 2rem" (click)="addSongArtist(j)">+</button>
                  <button
                    type="button"
                    class="btn btn-danger rounded-lg mx-1"
                    style="min-width: 2rem"
                    (click)="removeSongArtist(j, k)"
                    *ngIf="getSongArtists(j).controls.length > 1"
                  >
                    -
                  </button>
                </div>
              </div>
            </div>
          </div>
          <div class="form-group">
            <label for="releaseDate">{{ 'Release Date' | translate }}</label>
            <div class="input-group">
              <input
                class="form-control"
                placeholder="dd/MM/yyyy"
                id="releaseDate"
                name="dp"
                ngbDatepicker
                #d="ngbDatepicker"
                formControlName="releaseDate"
                [minDate]="minDate"
              />
              <div class="input-group-append">
                <button class="btn btn-outline-secondary" (click)="d.toggle()" type="button">
                  <i class="bi bi-calendar3"></i>
                </button>
              </div>
            </div>
            <vg-error-section
              [label]="'Release Date' | translate"
              [group]="songUploadData.formGroup"
              controlName="releaseDate"
            ></vg-error-section>
          </div>
          <div class="form-group">
            <label>{{ 'Audio File' | translate }}</label>
            <vg-file-input
              formControlName="url"
              [remoteFileType]="'audio'"
              [formData]="songUploadData.formData"
              [formDataFilePart]="'audio'"
              (metadataLoadedEvent)="retrieveSongDuration($event, songUploadData.formGroup)"
            ></vg-file-input>
          </div>
          <vg-upload-progress
            [httpObs]="songUploadData.observable"
            [successMsg]="'Song uploaded successfully' | translate"
            (successEvent)="uploadSongSuccess($event, songUploadData, j)"
            (failureEvent)="uploadSongFailed($event)"
          ></vg-upload-progress>
        </form>
      </div>
    </app-card>
  </div>
</div>
<div class="card col-sm-12" style="margin-bottom: 10rem; height: 10rem">
  <div class="card-body d-flex p-2 justify-content-center">
    <button class="align-self-center btn btn-info rounded-circle" (click)="addForm()">
      <i style="font-size: 2rem" class="bi bi-plus-circle"></i>
    </button>
  </div>
</div>

<div *ngIf="artist">
  <app-card [type]="2" [imgSrc]="artist.avatarUrl" [title]="'Artist Info' | translate" [showEditButton]="false">
    <div cardText2>
      <h6 class="d-inline">{{ 'Artist Name' | translate }}:&nbsp;</h6>
      <span class="text-secondary">{{artist.name}}</span><br />
      <h6 class="d-inline">{{ 'Date of Birth' | translate }}:&nbsp;</h6>
      <span class="text-secondary">{{artist.birthDate | date: 'fullDate' : '' : translate.currentLang}}</span><br />
      <h6 class="d-inline">{{ 'Biography' | translate }}:&nbsp;</h6>
      <p class="text-secondary" style="overflow-wrap: break-word">{{artist.biography}}</p>
    </div>
  </app-card>
</div>
<h3 class="text-center">{{ 'Song List' | translate }}</h3>
<div
  class="songList py-2"
  infiniteScroll
  [scrollWindow]="false"
  [infiniteScrollDistance]="2"
  [infiniteScrollThrottle]="50"
  (scrolled)="onScroll()"
>
  <table class="table table-striped py-2">
    <thead>
      <tr>
        <th scope="col">#</th>
        <th scope="col">{{ 'Title' | translate }}</th>
        <th scope="col">{{ 'Release Date' | translate }}</th>
        <th scope="col"></th>
        <th scope="col"></th>
        <th scope="col"></th>
      </tr>
    </thead>
    <tbody>
      <tr [routerLink]="['/song/detail']" [queryParams]="{id: song.id}" *ngFor="let song of songPage.content; index as i">
        <th scope="row">{{ song.rn }}</th>
        <td>
          <a [routerLink]="['/song','detail']" [queryParams]="{id: song.id}"><h5>{{song.title}}</h5></a>
          <a *ngFor="let artist of song.artists; index as j"
            ><small>{{ artist.name }}{{ j === song.artists.length - 1? '': ', '}}</small></a
          >
        </td>
        <td>
          <small>{{ song.duration | duration }}</small>
        </td>
        <td>
          <span class="float-right"
            ><small><i class="bi bi-headphones"></i> {{song.listeningFrequency}}</small></span
          >
        </td>
        <td>
          <ng-container *ngIf="!!currentUser">
            <button
              (click)="likeSong(song, i, $event, true)"
              class="btn btn-outline-danger btn-sm border-0"
              *ngIf="!song.liked"
              [disabled]="song.loadingLikeButton"
            >
              <span *ngIf="song.loadingLikeButton" class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
              <span *ngIf="!song.loadingLikeButton"><i class="bi bi-heart"></i></span>
            </button>
            <button
              (click)="likeSong(song, i, $event, false)"
              class="btn btn-outline-danger btn-sm border-0"
              *ngIf="song.liked"
              [disabled]="song.loadingLikeButton"
            >
              <span *ngIf="song.loadingLikeButton" class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
              <span *ngIf="!song.loadingLikeButton"><i class="bi bi-heart"></i></span>
            </button>
          </ng-container>
          <div ngbDropdown class="d-inline-block" placement="bottom" display="dynamic">
            <button (click)="$event.stopPropagation()" class="btn btn-outline-primary btn-sm" id="dropdownBasic1" ngbDropdownToggle>
              <i class="bi bi-three-dots-vertical"></i>
            </button>
            <div ngbDropdownMenu aria-labelledby="dropdownBasic1" class="dropdown_menu">
              <button ngbDropdownItem class="btn btn-primary btn-sm" (click)="addToPlaying(song, $event)" [disabled]="song.isDisabled">
                <i class="bi bi-play-circle mr-1"></i>{{ 'Add to Queue' | translate }}
              </button>
              <ng-container *ngIf="!!currentUser">
                <button ngbDropdownItem (click)="openPlaylistDialog(song.id, $event)" class="btn btn-primary btn-sm">
                  <i class="bi bi-plus-circle mr-1"></i>{{ 'Add to Playlist' | translate }}
                </button>
              </ng-container>
            </div>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>
